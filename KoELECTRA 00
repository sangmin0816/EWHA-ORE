{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"KoELECTRA 00","provenance":[{"file_id":"1JZ-pXlmgRIYHm8yPLYY68Q28l9OYAL6H","timestamp":1654745393556}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"797e53d7860d4b39893849794bae883d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5edf7dd0adf744cd8edd5a0367e979e1","IPY_MODEL_023cfed7be5c40f88616d8f137df553c","IPY_MODEL_d9da0461c56e4593a5e336f65742ed52"],"layout":"IPY_MODEL_ed9eb7e90b9f4b7ab94b535144e5d3ea"}},"5edf7dd0adf744cd8edd5a0367e979e1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_28b409b763af4ff991995cde27c99004","placeholder":"​","style":"IPY_MODEL_37bf0fd2b053461d803860bdeb791e5d","value":"100%"}},"023cfed7be5c40f88616d8f137df553c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b3783a9819264b62aac03a7861c42261","max":363,"min":0,"orientation":"horizontal","style":"IPY_MODEL_77cac7a58c6744779a21a9badaadba42","value":363}},"d9da0461c56e4593a5e336f65742ed52":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_642f782a3c16437684ef9c40bf81005b","placeholder":"​","style":"IPY_MODEL_a14b929622d2458ca009cb373d681edb","value":" 363/363 [07:55&lt;00:00,  1.01it/s]"}},"ed9eb7e90b9f4b7ab94b535144e5d3ea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"28b409b763af4ff991995cde27c99004":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"37bf0fd2b053461d803860bdeb791e5d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b3783a9819264b62aac03a7861c42261":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"77cac7a58c6744779a21a9badaadba42":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"642f782a3c16437684ef9c40bf81005b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a14b929622d2458ca009cb373d681edb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e7500ca00dda4071a37fa4b1209f36e4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_db2e05e38d404dfa8a6472caed1dad30","IPY_MODEL_fdacc825d4ae4275806b39719258bcd2","IPY_MODEL_7658a38115ca494fb968d5f18139743d"],"layout":"IPY_MODEL_26109febe8e74068aa1bd44ef50aff6a"}},"db2e05e38d404dfa8a6472caed1dad30":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f29f1814e1134752a138bb9c3e3ada44","placeholder":"​","style":"IPY_MODEL_9d7e87875fe74287a20785a5346a5827","value":"100%"}},"fdacc825d4ae4275806b39719258bcd2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e44167a75dd24db48a1f606afb319cb7","max":363,"min":0,"orientation":"horizontal","style":"IPY_MODEL_588cce7138b545dea7d0197d2b4e2551","value":363}},"7658a38115ca494fb968d5f18139743d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ef746728a713491196fd9a6d2230afe0","placeholder":"​","style":"IPY_MODEL_ac1eaa0d429e42a8882b5530ebc0dd6d","value":" 363/363 [07:52&lt;00:00,  1.01it/s]"}},"26109febe8e74068aa1bd44ef50aff6a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f29f1814e1134752a138bb9c3e3ada44":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9d7e87875fe74287a20785a5346a5827":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e44167a75dd24db48a1f606afb319cb7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"588cce7138b545dea7d0197d2b4e2551":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ef746728a713491196fd9a6d2230afe0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ac1eaa0d429e42a8882b5530ebc0dd6d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a972483f4c18421b89c2976ff76ed1f4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d4abc14a93b9478a91096c29b22bbea3","IPY_MODEL_c47ba2f63cf8436c918a38dbacf0a693","IPY_MODEL_9f841b016d06491c802540ccf2acfd91"],"layout":"IPY_MODEL_4956a9ac0952480c9ca3f5bd456a0c7e"}},"d4abc14a93b9478a91096c29b22bbea3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bcc43a58c8c84f6fa0e19e0bcd3eacec","placeholder":"​","style":"IPY_MODEL_502333e7db40420dad8e138bed6d9b57","value":"100%"}},"c47ba2f63cf8436c918a38dbacf0a693":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2e46d4894458440687bdd25cbb267cc4","max":363,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b13202d537d4402e9425fcffe0afa764","value":363}},"9f841b016d06491c802540ccf2acfd91":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e3697249046e48c0b74a5d65fdd4a296","placeholder":"​","style":"IPY_MODEL_f5e4824d0eff4d6c9fca35c65cb4127e","value":" 363/363 [07:52&lt;00:00,  1.01it/s]"}},"4956a9ac0952480c9ca3f5bd456a0c7e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bcc43a58c8c84f6fa0e19e0bcd3eacec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"502333e7db40420dad8e138bed6d9b57":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2e46d4894458440687bdd25cbb267cc4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b13202d537d4402e9425fcffe0afa764":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e3697249046e48c0b74a5d65fdd4a296":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f5e4824d0eff4d6c9fca35c65cb4127e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c1a620ca51404045a6c5e057f6bd2485":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b44c4a8b030b4310abc3818fd9b409a1","IPY_MODEL_badfbc1a5f60491fbb0a2522efbf36e6","IPY_MODEL_4c5cca6b95d049dc9dedcfe6a3014fe1"],"layout":"IPY_MODEL_bcadd3f8aae04a7dbd2288f8544e2a0d"}},"b44c4a8b030b4310abc3818fd9b409a1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8f15d130264144d7bbd02f5976c553bb","placeholder":"​","style":"IPY_MODEL_ad4d259227474990a67b758ce4bb7892","value":"100%"}},"badfbc1a5f60491fbb0a2522efbf36e6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7ec658f4e4c8414db4a6c1ba3a357901","max":363,"min":0,"orientation":"horizontal","style":"IPY_MODEL_00c8ce3cb3594160bc736793fdacd4e1","value":363}},"4c5cca6b95d049dc9dedcfe6a3014fe1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_33a420404d3d449e9b0a9f346894e805","placeholder":"​","style":"IPY_MODEL_c58b3059c6cc4a3695fd41443379f5f4","value":" 363/363 [07:52&lt;00:00,  1.01it/s]"}},"bcadd3f8aae04a7dbd2288f8544e2a0d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8f15d130264144d7bbd02f5976c553bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ad4d259227474990a67b758ce4bb7892":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7ec658f4e4c8414db4a6c1ba3a357901":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00c8ce3cb3594160bc736793fdacd4e1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"33a420404d3d449e9b0a9f346894e805":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c58b3059c6cc4a3695fd41443379f5f4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6001623561074d73864a87098828361e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_04e0bb0e8a4a4924a4c6a35dfbac480d","IPY_MODEL_8c58c50b46fd4c20806f5bd5ca0a1248","IPY_MODEL_5eab8ccd71a04c2d93d3f55ea2f17925"],"layout":"IPY_MODEL_02b245bf6aa94931a5668282656a260c"}},"04e0bb0e8a4a4924a4c6a35dfbac480d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3358fe59dca549e4add0280052d776ee","placeholder":"​","style":"IPY_MODEL_b39eda5bc4d544568e76f7d769f49ea3","value":"100%"}},"8c58c50b46fd4c20806f5bd5ca0a1248":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e6f30eb80a1f41f7a4a8ade2088bb7a2","max":363,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3a8336bc10994916a79d38f5d92aa161","value":363}},"5eab8ccd71a04c2d93d3f55ea2f17925":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d18f25e886e94ffb863a19f36486fb10","placeholder":"​","style":"IPY_MODEL_122f0bedfd8f4ff684648031d5c47de0","value":" 363/363 [07:52&lt;00:00,  1.02it/s]"}},"02b245bf6aa94931a5668282656a260c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3358fe59dca549e4add0280052d776ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b39eda5bc4d544568e76f7d769f49ea3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e6f30eb80a1f41f7a4a8ade2088bb7a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a8336bc10994916a79d38f5d92aa161":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d18f25e886e94ffb863a19f36486fb10":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"122f0bedfd8f4ff684648031d5c47de0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7dd5bcc2d6904054948981f10bc14f6e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d3b54e1eec2a498d981fbe1087f88212","IPY_MODEL_c65e82b14b3047e5a1cf53fe4f16c489","IPY_MODEL_ed664b4a86444fd1ab337391046ce96b"],"layout":"IPY_MODEL_4ce0b6608c304d2486f6805a05cbda47"}},"d3b54e1eec2a498d981fbe1087f88212":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0ab8ddf8a0c245fe80d48189db1e1dd6","placeholder":"​","style":"IPY_MODEL_b3e274a2ccbd406cbb5d78af9e1fd6b9","value":"100%"}},"c65e82b14b3047e5a1cf53fe4f16c489":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b41fba1099724d7fb5321f77ca7cefd0","max":182,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bc4399932f3f40e3b820a694483fab7e","value":182}},"ed664b4a86444fd1ab337391046ce96b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1728aa1384364913a223ab3c03b0fc48","placeholder":"​","style":"IPY_MODEL_233cab637c014edf86e7736172e6428d","value":" 182/182 [00:42&lt;00:00,  4.21it/s]"}},"4ce0b6608c304d2486f6805a05cbda47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ab8ddf8a0c245fe80d48189db1e1dd6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b3e274a2ccbd406cbb5d78af9e1fd6b9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b41fba1099724d7fb5321f77ca7cefd0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bc4399932f3f40e3b820a694483fab7e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1728aa1384364913a223ab3c03b0fc48":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"233cab637c014edf86e7736172e6428d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"cdjLL9gvyVCR"},"source":["\n","# Pytorch + HuggingFace \n","## KoElectra Model\n","박장원님의 KoElectra-small 사용<br>\n","https://monologg.kr/2020/05/02/koelectra-part1/<br>\n","https://github.com/monologg/KoELECTRA\n","\n","## Dataset\n","네이버 영화 리뷰 데이터셋<br>\n","https://github.com/e9t/nsmc\n","\n","## References\n","- https://huggingface.co/transformers/training.html\n","- https://tutorials.pytorch.kr/beginner/data_loading_tutorial.html\n","- https://tutorials.pytorch.kr/beginner/blitz/cifar10_tutorial.html\n","- https://wikidocs.net/44249\n","\n","## 주의사항\n","꼭 GPU로 해주세요 - 1epoch 당 약 20분 소요"]},{"cell_type":"code","metadata":{"id":"-iFVHYMAwQUt","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1654784673214,"user_tz":-540,"elapsed":22402,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"outputId":"f38cacd7-6dda-4a6c-e221-e1b638eeebed"},"source":["!pip install transformers\n","import pandas as pd\n","import torch\n","from torch.nn import functional as F\n","from torch.utils.data import DataLoader, Dataset\n","from transformers import AutoTokenizer, ElectraForSequenceClassification, AdamW\n","from tqdm.notebook import tqdm"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.19.2-py3-none-any.whl (4.2 MB)\n","\u001b[K     |████████████████████████████████| 4.2 MB 12.1 MB/s \n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Collecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 54.4 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.4)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.7.0)\n","Collecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.7.0-py3-none-any.whl (86 kB)\n","\u001b[K     |████████████████████████████████| 86 kB 6.6 MB/s \n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 37.7 MB/s \n","\u001b[?25hRequirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.5.18.1)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Installing collected packages: pyyaml, tokenizers, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.7.0 pyyaml-6.0 tokenizers-0.12.1 transformers-4.19.2\n"]}]},{"cell_type":"code","metadata":{"id":"-i7pg7DaGsxp"},"source":["# GPU 사용\n","device = torch.device(\"cuda\")"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Rq91g3bGwfeV"},"source":["# Dataset 만들어서 불러오기 "]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KVYT3fYE3CeN","executionInfo":{"status":"ok","timestamp":1654784693080,"user_tz":-540,"elapsed":19879,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"outputId":"41135991-1312-42e8-b084-beaf2feb3d6b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["def train_test(data_path):\n","  import pandas as pd\n","  from sklearn.model_selection import train_test_split\n","  \n","  dataset = pd.DataFrame()\n","  for data in data_path:\n","    temp = pd.read_excel(data)\n","    temp = temp[['document', 'label']]\n","\n","    temp = temp.astype({'label':float})\n","    temp = temp.astype({'document':str})\n","    dataset = pd.concat([temp, dataset])\n","  \n","  dataset_train, dataset_test = train_test_split(dataset, test_size = 0.2, train_size = 0.8, shuffle=True)\n","\n","  return dataset_train, dataset_test"],"metadata":{"id":"Ajbe308O2UZ8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["datas = ['/content/drive/MyDrive/Colab Notebooks/deeplearning/data/unsmile+kocohub_train.xlsx', '/content/drive/MyDrive/Colab Notebooks/deeplearning/data/unsmile+kocohub_test.xlsx']\n","train, test = train_test(datas)\n","train.to_csv('/content/train.csv')\n","test.to_csv('/content/test.csv')"],"metadata":{"id":"L2sCdIXn2X3n"},"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"WZKIQNjZwdn1"},"source":["class NSMCDataset(Dataset):\n","  \n","  def __init__(self, csv_file):\n","    # 일부 값중에 NaN이 있음...\n","    self.dataset = pd.read_csv(csv_file, sep=',').dropna(axis=0) \n","    # 중복제거\n","    self.tokenizer = AutoTokenizer.from_pretrained(\"monologg/koelectra-small-v2-discriminator\")\n","\n","    print(self.dataset.describe())\n","  \n","  def __len__(self):\n","    return len(self.dataset)\n","  \n","  def __getitem__(self, idx):\n","    row = self.dataset.loc[idx,['document', 'label']].values\n","    text = row[0]\n","    y = int(row[1])\n","\n","    inputs = self.tokenizer(\n","        text=text, \n","        return_tensors='pt',\n","        truncation=True,\n","        max_length=256,\n","        pad_to_max_length=True,\n","        add_special_tokens=True\n","        )\n","    \n","    input_ids = inputs['input_ids'][0]\n","    attention_mask = inputs['attention_mask'][0]\n","\n","    return input_ids, attention_mask, y"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ESSNkTcXwfUe","executionInfo":{"status":"ok","timestamp":1654785051736,"user_tz":-540,"elapsed":7449,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"61822f6f-5b9b-464d-b1fa-852ea9ded060"},"source":["train_dataset = NSMCDataset('/content/train.csv')\n","test_dataset = NSMCDataset('/content/test.csv')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["         Unnamed: 0         label\n","count  11589.000000  11589.000000\n","mean    4893.844076      0.784796\n","std     3466.237125      0.410982\n","min        0.000000      0.000000\n","25%     1799.000000      1.000000\n","50%     4306.000000      1.000000\n","75%     7892.000000      1.000000\n","max    11588.000000      1.000000\n","         Unnamed: 0        label\n","count   2898.000000  2898.000000\n","mean    5048.191856     0.773982\n","std     3536.261239     0.418323\n","min        5.000000     0.000000\n","25%     1856.000000     1.000000\n","50%     4467.000000     1.000000\n","75%     8226.250000     1.000000\n","max    11587.000000     1.000000\n"]}]},{"cell_type":"markdown","metadata":{"id":"vJiAJPUDz40W"},"source":["# Create Model"]},{"cell_type":"code","metadata":{"id":"f7-jRPQXz2r5","executionInfo":{"status":"ok","timestamp":1654785053799,"user_tz":-540,"elapsed":2069,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"bd2bd099-7680-4493-857f-b875c0538f4c"},"source":["model = ElectraForSequenceClassification.from_pretrained(\"monologg/koelectra-base-v3-discriminator\").to(device)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at monologg/koelectra-base-v3-discriminator were not used when initializing ElectraForSequenceClassification: ['discriminator_predictions.dense.bias', 'discriminator_predictions.dense_prediction.bias', 'discriminator_predictions.dense.weight', 'discriminator_predictions.dense_prediction.weight']\n","- This IS expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing ElectraForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at monologg/koelectra-base-v3-discriminator and are newly initialized: ['classifier.dense.weight', 'classifier.dense.bias', 'classifier.out_proj.bias', 'classifier.out_proj.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}]},{"cell_type":"code","source":["# 한번 실행해보세요\n","text, attention_mask, y = train_dataset[0]\n","model(text.unsqueeze(0).to(device), attention_mask=attention_mask.unsqueeze(0).to(device))"],"metadata":{"id":"Rn95dAaQPT0r","executionInfo":{"status":"ok","timestamp":1654785053800,"user_tz":-540,"elapsed":7,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"d65dbe82-53fa-485c-d2be-e7f82354ba11"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py:2291: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding='longest'` to pad to the longest sequence in the batch, or use `padding='max_length'` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).\n","  FutureWarning,\n"]},{"output_type":"execute_result","data":{"text/plain":["SequenceClassifierOutput([('logits',\n","                           tensor([[0.0541, 0.0396]], device='cuda:0', grad_fn=<AddmmBackward0>))])"]},"metadata":{},"execution_count":33}]},{"cell_type":"code","metadata":{"id":"edb0aIFaXr4D"},"source":["# model.load_state_dict(torch.load(\"/content/model.pt\"))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"Dp6x4GHtz46u"},"source":["# 모델 레이어 보기\n","model"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"wmou0LFl0R_X"},"source":["# Learn"]},{"cell_type":"code","metadata":{"id":"6NpXwESN0Q4h"},"source":["epochs = 5\n","batch_size = 32"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"XPzxoo4H274J","executionInfo":{"status":"ok","timestamp":1654785464459,"user_tz":-540,"elapsed":9,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"af008c3b-bfb6-45ac-9ee0-6b52db0348d7"},"source":["optimizer = AdamW(model.parameters(), lr=5e-2)\n","train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=True)\n","test_loader = DataLoader(test_dataset, batch_size=16, shuffle=True)"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/optimization.py:309: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  FutureWarning,\n"]}]},{"cell_type":"code","metadata":{"id":"M-BRNeE226HH","executionInfo":{"status":"ok","timestamp":1654787829321,"user_tz":-540,"elapsed":2364869,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/","height":596,"referenced_widgets":["797e53d7860d4b39893849794bae883d","5edf7dd0adf744cd8edd5a0367e979e1","023cfed7be5c40f88616d8f137df553c","d9da0461c56e4593a5e336f65742ed52","ed9eb7e90b9f4b7ab94b535144e5d3ea","28b409b763af4ff991995cde27c99004","37bf0fd2b053461d803860bdeb791e5d","b3783a9819264b62aac03a7861c42261","77cac7a58c6744779a21a9badaadba42","642f782a3c16437684ef9c40bf81005b","a14b929622d2458ca009cb373d681edb","e7500ca00dda4071a37fa4b1209f36e4","db2e05e38d404dfa8a6472caed1dad30","fdacc825d4ae4275806b39719258bcd2","7658a38115ca494fb968d5f18139743d","26109febe8e74068aa1bd44ef50aff6a","f29f1814e1134752a138bb9c3e3ada44","9d7e87875fe74287a20785a5346a5827","e44167a75dd24db48a1f606afb319cb7","588cce7138b545dea7d0197d2b4e2551","ef746728a713491196fd9a6d2230afe0","ac1eaa0d429e42a8882b5530ebc0dd6d","a972483f4c18421b89c2976ff76ed1f4","d4abc14a93b9478a91096c29b22bbea3","c47ba2f63cf8436c918a38dbacf0a693","9f841b016d06491c802540ccf2acfd91","4956a9ac0952480c9ca3f5bd456a0c7e","bcc43a58c8c84f6fa0e19e0bcd3eacec","502333e7db40420dad8e138bed6d9b57","2e46d4894458440687bdd25cbb267cc4","b13202d537d4402e9425fcffe0afa764","e3697249046e48c0b74a5d65fdd4a296","f5e4824d0eff4d6c9fca35c65cb4127e","c1a620ca51404045a6c5e057f6bd2485","b44c4a8b030b4310abc3818fd9b409a1","badfbc1a5f60491fbb0a2522efbf36e6","4c5cca6b95d049dc9dedcfe6a3014fe1","bcadd3f8aae04a7dbd2288f8544e2a0d","8f15d130264144d7bbd02f5976c553bb","ad4d259227474990a67b758ce4bb7892","7ec658f4e4c8414db4a6c1ba3a357901","00c8ce3cb3594160bc736793fdacd4e1","33a420404d3d449e9b0a9f346894e805","c58b3059c6cc4a3695fd41443379f5f4","6001623561074d73864a87098828361e","04e0bb0e8a4a4924a4c6a35dfbac480d","8c58c50b46fd4c20806f5bd5ca0a1248","5eab8ccd71a04c2d93d3f55ea2f17925","02b245bf6aa94931a5668282656a260c","3358fe59dca549e4add0280052d776ee","b39eda5bc4d544568e76f7d769f49ea3","e6f30eb80a1f41f7a4a8ade2088bb7a2","3a8336bc10994916a79d38f5d92aa161","d18f25e886e94ffb863a19f36486fb10","122f0bedfd8f4ff684648031d5c47de0"]},"outputId":"955e6bee-1241-49ed-9374-2eaac10c6cce"},"source":["losses = []\n","accuracies = []\n","\n","for i in range(epochs):\n","  total_loss = 0.0\n","  correct = 0\n","  total = 0\n","  batches = 0\n","\n","  model.train()\n","\n","  for input_ids_batch, attention_masks_batch, y_batch in tqdm(train_loader):\n","    optimizer.zero_grad()\n","    y_batch = y_batch.to(device)\n","    y_pred = model(input_ids_batch.to(device), attention_mask=attention_masks_batch.to(device))[0]\n","    loss = F.cross_entropy(y_pred, y_batch)\n","    loss.backward()\n","    optimizer.step()\n","\n","    total_loss += loss.item()\n","\n","    _, predicted = torch.max(y_pred, 1)\n","    correct += (predicted == y_batch).sum()\n","    total += len(y_batch)\n","\n","    batches += 1\n","    if batches % 100 == 0:\n","      print(\"Batch Loss:\", total_loss, \"Accuracy:\", correct.float() / total)\n","  \n","  losses.append(total_loss)\n","  accuracies.append(correct.float() / total)\n","  print(\"Train Loss:\", total_loss, \"Accuracy:\", correct.float() / total)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/363 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"797e53d7860d4b39893849794bae883d"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py:2291: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding='longest'` to pad to the longest sequence in the batch, or use `padding='max_length'` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).\n","  FutureWarning,\n"]},{"output_type":"stream","name":"stdout","text":["Batch Loss: 135283.89405733347 Accuracy: tensor(0.6712, device='cuda:0')\n","Batch Loss: 135364.9055968523 Accuracy: tensor(0.7188, device='cuda:0')\n","Batch Loss: 135416.4292626977 Accuracy: tensor(0.7430, device='cuda:0')\n","Train Loss: 135448.72187918425 Accuracy: tensor(0.7513, device='cuda:0')\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/363 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e7500ca00dda4071a37fa4b1209f36e4"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Batch Loss: 58.528709918260574 Accuracy: tensor(0.7809, device='cuda:0')\n","Batch Loss: 110.43672242760658 Accuracy: tensor(0.7887, device='cuda:0')\n","Batch Loss: 162.3864690065384 Accuracy: tensor(0.7884, device='cuda:0')\n","Train Loss: 196.48460164666176 Accuracy: tensor(0.7847, device='cuda:0')\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/363 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a972483f4c18421b89c2976ff76ed1f4"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Batch Loss: 56.7221018075943 Accuracy: tensor(0.7956, device='cuda:0')\n","Batch Loss: 116.15566918253899 Accuracy: tensor(0.7916, device='cuda:0')\n","Batch Loss: 169.15427780151367 Accuracy: tensor(0.7874, device='cuda:0')\n","Train Loss: 203.6329971551895 Accuracy: tensor(0.7841, device='cuda:0')\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/363 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c1a620ca51404045a6c5e057f6bd2485"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Batch Loss: 50.610693871974945 Accuracy: tensor(0.7981, device='cuda:0')\n","Batch Loss: 103.20355620980263 Accuracy: tensor(0.7898, device='cuda:0')\n","Batch Loss: 155.726247549057 Accuracy: tensor(0.7874, device='cuda:0')\n","Train Loss: 189.5296638906002 Accuracy: tensor(0.7848, device='cuda:0')\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/363 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6001623561074d73864a87098828361e"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Batch Loss: 51.803870677948 Accuracy: tensor(0.7884, device='cuda:0')\n","Batch Loss: 104.04315960407257 Accuracy: tensor(0.7864, device='cuda:0')\n","Batch Loss: 156.35817997157574 Accuracy: tensor(0.7856, device='cuda:0')\n","Train Loss: 189.5544923990965 Accuracy: tensor(0.7848, device='cuda:0')\n"]}]},{"cell_type":"code","metadata":{"id":"IQK4R6n4JgVU","executionInfo":{"status":"ok","timestamp":1654787829322,"user_tz":-540,"elapsed":20,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"02a8474e-755d-4bb1-f283-d07752ba0d0a"},"source":["losses, accuracies"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["([135448.72187918425,\n","  196.48460164666176,\n","  203.6329971551895,\n","  189.5296638906002,\n","  189.5544923990965],\n"," [tensor(0.7513, device='cuda:0'),\n","  tensor(0.7847, device='cuda:0'),\n","  tensor(0.7841, device='cuda:0'),\n","  tensor(0.7848, device='cuda:0'),\n","  tensor(0.7848, device='cuda:0')])"]},"metadata":{},"execution_count":42}]},{"cell_type":"markdown","metadata":{"id":"qvEB8g7IFbsD"},"source":["테스트 데이터셋 정확도 확인하기"]},{"cell_type":"code","metadata":{"id":"5QiALUqm4juf","executionInfo":{"status":"ok","timestamp":1654787872414,"user_tz":-540,"elapsed":43101,"user":{"displayName":"이화오르","userId":"15530802963552486964"}},"colab":{"base_uri":"https://localhost:8080/","height":123,"referenced_widgets":["7dd5bcc2d6904054948981f10bc14f6e","d3b54e1eec2a498d981fbe1087f88212","c65e82b14b3047e5a1cf53fe4f16c489","ed664b4a86444fd1ab337391046ce96b","4ce0b6608c304d2486f6805a05cbda47","0ab8ddf8a0c245fe80d48189db1e1dd6","b3e274a2ccbd406cbb5d78af9e1fd6b9","b41fba1099724d7fb5321f77ca7cefd0","bc4399932f3f40e3b820a694483fab7e","1728aa1384364913a223ab3c03b0fc48","233cab637c014edf86e7736172e6428d"]},"outputId":"c4e1fe99-8fcd-4104-af73-fa6a03b373d7"},"source":["model.eval()\n","\n","test_correct = 0\n","test_total = 0\n","\n","for input_ids_batch, attention_masks_batch, y_batch in tqdm(test_loader):\n","  y_batch = y_batch.to(device)\n","  y_pred = model(input_ids_batch.to(device), attention_mask=attention_masks_batch.to(device))[0]\n","  _, predicted = torch.max(y_pred, 1)\n","  test_correct += (predicted == y_batch).sum()\n","  test_total += len(y_batch)\n","\n","print(\"Accuracy:\", test_correct.float() / test_total)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/182 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7dd5bcc2d6904054948981f10bc14f6e"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py:2291: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding='longest'` to pad to the longest sequence in the batch, or use `padding='max_length'` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).\n","  FutureWarning,\n"]},{"output_type":"stream","name":"stdout","text":["Accuracy: tensor(0.7740, device='cuda:0')\n"]}]},{"cell_type":"code","metadata":{"id":"rrcPWEa5U8JZ"},"source":["# 모델 저장하기\n","torch.save(model, \"/content/drive/MyDrive/Colab Notebooks/deeplearning/trained_model/koelectra_model.pt\")"],"execution_count":null,"outputs":[]},{"cell_type":"code","source":["prediction = pd.read_excel(\"/content/drive/MyDrive/Colab Notebooks/deeplearning/data/Ewha_Presentation.xlsx\")\n","prediction.to_csv('/content/prediction.csv')\n","pred_data =  NSMCDataset('/content/prediction.csv')\n","pred_loader = DataLoader(pred_dataset, batch_size=batch_size, shuffle=True)"],"metadata":{"id":"qhqjEiH-fyQ4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.eval()\n","predicted_data = []\n","for input_ids_batch, attention_masks_batch, y_batch in tqdm(test_loader):\n","  y_batch = y_batch.to(device)\n","  y_pred = model(input_ids_batch.to(device), attention_mask=attention_masks_batch.to(device))[0]\n","  _, predicted = torch.max(y_pred, 1)\n","  predicted_data.append(predicted)\n","  test_correct += (predicted == y_batch).sum()\n","  test_total += len(y_batch)\n","\n","print(\"Accuracy:\", test_correct.float() / test_total)"],"metadata":{"id":"gN6t_KBtU7B9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(predicted_data)"],"metadata":{"id":"zY77SPy5gGXn"},"execution_count":null,"outputs":[]}]}